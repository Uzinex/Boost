"""
Uzinex Boost ‚Äî Referral Events
==============================

–°–æ–±—ã—Ç–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Uzinex Boost.

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
-----------
- —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏;
- –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞—á–∏—Å–ª—è—Ç—å –±–æ–Ω—É—Å—ã –∏ —Å—Ç—Ä–æ–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É —Ä–æ—Å—Ç–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞;
- –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è —Å –±–∞–ª–∞–Ω—Å–æ–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏.

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:
---------------
- domain.services.referral
- domain.services.balance
- adapters.analytics
- adapters.notifications
"""

from __future__ import annotations
from datetime import datetime
from pydantic import Field

from domain.events.base import DomainEvent


# -------------------------------------------------
# üîπ –°–æ–±—ã—Ç–∏–µ: –ù–æ–≤—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª –ø—Ä–∏–≥–ª–∞—à—ë–Ω
# -------------------------------------------------
class ReferralInvitedEvent(DomainEvent):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–æ–≤–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É."""

    event_type: str = "referral.invited"
    inviter_id: int = Field(..., description="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ –Ω–æ–≤–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞")
    invitee_email: str = Field(..., description="Email –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")
    invite_code: str = Field(..., description="–ö–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –∏–ª–∏ —Å—Å—ã–ª–∫–∞")
    invited_at: datetime = Field(default_factory=datetime.utcnow)


# -------------------------------------------------
# üîπ –°–æ–±—ã—Ç–∏–µ: –ù–æ–≤—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
# -------------------------------------------------
class ReferralRegisteredEvent(DomainEvent):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é."""

    event_type: str = "referral.registered"
    inviter_id: int = Field(..., description="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞")
    referral_id: int = Field(..., description="ID –Ω–æ–≤–æ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")
    referral_email: str | None = Field(None, description="Email –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—Å—Ç—å)")
    registered_at: datetime = Field(default_factory=datetime.utcnow)


# -------------------------------------------------
# üîπ –°–æ–±—ã—Ç–∏–µ: –ù–æ–≤—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è
# -------------------------------------------------
class ReferralJoinedEvent(DomainEvent):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è."""

    event_type: str = "referral.joined"
    inviter_id: int
    referral_id: int = Field(..., description="ID –Ω–æ–≤–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞")
    joined_at: datetime = Field(default_factory=datetime.utcnow)


# -------------------------------------------------
# üîπ –°–æ–±—ã—Ç–∏–µ: –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å –Ω–∞—á–∏—Å–ª–µ–Ω
# -------------------------------------------------
class ReferralRewardedEvent(DomainEvent):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –±–æ–Ω—É—Å –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –µ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞."""

    event_type: str = "referral.rewarded"
    inviter_id: int = Field(..., description="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–ª—É—á–∏–≤—à–µ–≥–æ –±–æ–Ω—É—Å")
    referral_id: int = Field(..., description="ID —Ä–µ—Ñ–µ—Ä–∞–ª–∞, –∑–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞—á–∏—Å–ª–µ–Ω –±–æ–Ω—É—Å")
    amount: float = Field(..., description="–°—É–º–º–∞ –±–æ–Ω—É—Å–∞ (UZT)")
    reason: str = Field(..., description="–ü—Ä–∏—á–∏–Ω–∞ –±–æ–Ω—É—Å–∞ (signup, task_completed, deposit –∏ —Ç.–¥.)")
    transaction_id: int | None = Field(None, description="ID —Å–≤—è–∑–∞–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏")
    rewarded_at: datetime = Field(default_factory=datetime.utcnow)


# -------------------------------------------------
# üîπ –°–æ–±—ã—Ç–∏–µ: –î–æ—Å—Ç–∏–≥–Ω—É—Ç –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã
# -------------------------------------------------
class ReferralLevelUpEvent(DomainEvent):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã."""

    event_type: str = "referral.level_up"
    user_id: int = Field(..., description="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –¥–æ—Å—Ç–∏–≥—à–µ–≥–æ –Ω–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è")
    new_level: int = Field(..., description="–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å –≤ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ")
    bonus_amount: float = Field(default=0.0, description="–ë–æ–Ω—É—Å –∑–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è, –µ—Å–ª–∏ –µ—Å—Ç—å")
    achieved_at: datetime = Field(default_factory=datetime.utcnow)
