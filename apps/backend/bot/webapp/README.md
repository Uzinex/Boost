# Uzinex Boost Telegram WebApp

Профессиональный интерфейс WebApp для Telegram-бота Uzinex Boost. Проект построен на Vite и предоставляет современный UX для управления балансом, заданиями, заказами и платежами пользователей платформы.

## Возможности

- Авторизация по `initData` из Telegram WebApp.
- Дашборд с карточками метрик, историей операций и быстрым доступом к заданиям.
- Полноценные разделы для задач исполнителя, заказов рекламодателя, пополнений и профиля.
- Работа с REST API бэкенда, обработка ошибок и уведомлений через тосты.
- Поддержка светлой/тёмной темы на основе параметров Telegram.
- Адаптивная верстка, оптимизированная под мобильные устройства.

## Структура каталогов

```
apps/backend/bot/webapp
├── index.html        # Точка входа WebApp
├── package.json      # Конфигурация npm-скриптов и зависимостей
├── public/           # Статические ассеты (CSS и т.п.)
├── src/              # Исходный код модулей WebApp
├── eslint.config.js  # Правила линтинга
└── vite.config.js    # Конфигурация Vite
```

## Быстрый старт

```bash
cd apps/backend/bot/webapp
npm install
npm run dev
```

Сборка production-версии:

```bash
npm run build
```

Предпросмотр собранной версии:

```bash
npm run preview
```

## Переменные конфигурации

WebApp считывает JSON-конфигурацию из тега `<script id="boost-config">` в `index.html`. Доступные параметры:

- `apiBaseUrl` — базовый URL REST API (по умолчанию `/api/v1`).
- `botToken` — токен Telegram-бота для авторизации WebApp.
- `locale` — локаль интерфейса (используется для форматирования дат и чисел).
- `mockInitData` — строка initData для тестов (если WebApp запускается вне Telegram).
- `mockAuthEnabled` — включает mock-авторизацию (без initData) при отсутствии Telegram (по умолчанию включено).
- `mockAuthUser` — объект с данными тестового пользователя (id, username, first/last name).
- `mockAuthParams` — дополнительные query-параметры для запроса mock-авторизации.

При необходимости конфигурацию можно переопределить до загрузки `src/main.js`, задав `window.__BOOST_CONFIG`.

### Mock-авторизация WebApp

Для локального тестирования без Telegram WebApp добавлен мок-эндпоинт `POST /api/v1/telegram/auth/mock`. Он активируется,
если на бэкенде включён `TELEGRAM_DEBUG_MODE` (по умолчанию — для всех окружений, кроме production).

**Как запустить mock-режим:**

1. Включите флаг `mockAuthEnabled` в конфигурации WebApp или откройте URL с параметром `?mock=1`.
2. По желанию передайте в URL `telegram_id`, `username`, `first_name`, `last_name`, `language`.
3. Приложение выполнит авторизацию через mock-эндпоинт и создаст (или обновит) тестового пользователя.

> ⚠️ Mock-авторизация предназначена только для отладки. В production-окружении она автоматически отключена.

> ℹ️ Для импорта модулей используйте алиас `@`, который указывает на каталог `src` (например, `import { api } from '@/api.js'`).

## Код-стайл и проверка качества

- ESLint настроен на современные правила (`@eslint/js`) и проверяет как JS-модули, так и HTML-шаблоны.
- Prettier используется для единообразного форматирования.

Запуск линтера:

```bash
npm run lint
```

Или автоматически исправить возможные замечания:

```bash
npm run lint:fix
```

## Дальнейшее развитие

- Подключение реальных API-эндпойнтов вместо заглушек.
- Добавление e2e-тестов через Playwright для критичных пользовательских сценариев.
- Настройка CI/CD для автоматической сборки и деплоя WebApp вместе с backend.
