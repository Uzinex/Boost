<!DOCTYPE html>
<html lang="ru" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <meta name="theme-color" content="#2563eb" />
    <meta
      name="description"
      content="Uzinex Boost · Telegram WebApp для заработка на заданиях, управления заказами и балансом платформы"
    />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <title>Uzinex Boost WebApp</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles/main.css" />
    <link rel="stylesheet" href="/styles/tasks.css" />
    <link rel="stylesheet" href="/styles/orders.css" />
    <link rel="stylesheet" href="/styles/payments.css" />
    <link rel="stylesheet" href="/styles/profile.css" />

    <!-- ✅ Конфигурация Boost WebApp -->
    <script id="boost-config" type="application/json">
      {
        "apiBaseUrl": "https://boost-production-602a.up.railway.app/api/v1",
        "botToken": "YOUR_BOT_TOKEN_HERE",
        "mockAuthEnabled": true,
        "mockAuthUser": {
          "telegram_id": 999000000,
          "username": "boost_demo",
          "first_name": "Boost",
          "last_name": "Tester",
          "language_code": "ru"
        }
      }
    </script>

    <!-- ✅ Предзагруженные данные, которые может подставлять backend (баланс, статистика и т.д.) -->
    <script id="boost-snapshot" type="application/json">
      {
        "user": null,
        "profile": null,
        "balance": 0,
        "stats": {
          "user": null,
          "public": null,
          "orders": null
        },
        "tasks": [],
        "taskHistory": [],
        "orders": [],
        "payments": [],
        "balanceHistory": [],
        "referrals": []
      }
    </script>
  </head>

  <body>
    <div class="app-shell">
      <header class="app-header">
        <div>
          <h1 class="app-title">Uzinex Boost</h1>
          <p class="app-subtitle">Telegram WebApp · заработок и продвижение</p>
        </div>
        <div class="user-chip" id="user-chip">
          <span class="user-chip__name" id="chip-name">Пользователь</span>
          <span class="user-chip__balance" id="chip-balance">0,00 UZT</span>
        </div>
      </header>

      <nav class="app-nav" aria-label="Основная навигация">
        <button class="nav-btn is-active" data-view="dashboard">Главная</button>
        <button class="nav-btn" data-view="tasks">Задания</button>
        <button class="nav-btn" data-view="orders">Заказы</button>
        <button class="nav-btn" data-view="payments">Пополнения</button>
        <button class="nav-btn" data-view="profile">Профиль</button>
      </nav>

      <main class="app-main">
        <section class="view" id="view-dashboard" data-view="dashboard">
          <div class="grid grid--cards" id="dashboard-cards">
            <article class="card">
              <h2>Баланс</h2>
              <p class="metric" id="metric-balance">0,00 UZT</p>
              <p class="muted">Актуальный баланс в UZT</p>
            </article>
            <article class="card">
              <h2>Заработано</h2>
              <p class="metric" id="metric-earned">0,00 UZT</p>
              <p class="muted">Всего начислено за задания</p>
            </article>
            <article class="card">
              <h2>Заказы</h2>
              <p class="metric" id="metric-orders">0</p>
              <p class="muted">Активные и завершённые кампании</p>
            </article>
            <article class="card">
              <h2>Рефералы</h2>
              <p class="metric" id="metric-referrals">0</p>
              <p class="muted">Приглашённые пользователи</p>
            </article>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>Актуальные задания</h3>
              <button class="btn btn--ghost" id="refresh-dashboard-tasks">Обновить</button>
            </div>
            <ul class="list" id="dashboard-tasks"></ul>
            <p class="muted" id="dashboard-tasks-empty">Пока нет активных заданий.</p>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>История операций</h3>
              <div class="panel__actions">
                <button class="btn btn--ghost" id="refresh-dashboard-history">Обновить</button>
                <button class="btn btn--ghost" id="open-payments-view" data-view="payments">
                  Все операции
                </button>
              </div>
            </div>
            <div class="timeline" id="dashboard-history"></div>
            <p class="muted" id="dashboard-history-empty">Операций ещё не было.</p>
          </div>
        </section>

        <section class="view" id="view-tasks" data-view="tasks" hidden>
          <header class="section-header">
            <div>
              <h2>Задания</h2>
              <p class="muted">Выбирайте задания, чтобы пополнять баланс и продвигаться в рейтинге.</p>
            </div>
            <div class="section-actions">
              <button class="btn btn--ghost" data-view-target="dashboard">На главную</button>
              <button class="btn btn--primary" id="tasks-refresh">Обновить</button>
            </div>
          </header>

          <div class="panel">
            <div class="panel__header">
              <div>
                <h3>Актуальные задания</h3>
                <p class="muted">Фильтруйте задания по типу и стоимости.</p>
              </div>
              <div class="panel__actions filter-group" data-filter-group="tasks">
                <button class="btn btn--chip is-active" data-task-filter="all">Все</button>
                <button class="btn btn--chip" data-task-filter="social">Соцсети</button>
                <button class="btn btn--chip" data-task-filter="video">Просмотры</button>
                <button class="btn btn--chip" data-task-filter="review">Отзывы</button>
              </div>
            </div>
            <ul class="list" id="tasks-list"></ul>
            <p class="muted" id="tasks-empty">Список пуст — ожидаем новых заданий.</p>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>История заданий</h3>
              <div class="panel__actions">
                <button class="btn btn--ghost" data-view-target="payments">Начисления</button>
              </div>
            </div>
            <div class="timeline" id="tasks-history"></div>
            <p class="muted" id="tasks-history-empty">Вы ещё не выполняли задания.</p>
          </div>
        </section>

        <section class="view" id="view-orders" data-view="orders" hidden>
          <header class="section-header">
            <div>
              <h2>Заказы</h2>
              <p class="muted">Управляйте своими рекламными кампаниями и отслеживайте прогресс.</p>
            </div>
            <div class="section-actions">
              <button class="btn btn--ghost" id="orders-refresh">Обновить</button>
              <button class="btn btn--primary" id="orders-create">Создать заказ</button>
            </div>
          </header>

          <div class="grid grid--cards orders-summary" id="orders-summary">
            <article class="card">
              <p class="muted">Активные</p>
              <p class="metric" id="orders-active">0</p>
              <p class="muted">Кампании, которые выполняются прямо сейчас.</p>
            </article>
            <article class="card">
              <p class="muted">Завершённые</p>
              <p class="metric" id="orders-completed">0</p>
              <p class="muted">Успешно выполненные задания рекламодателя.</p>
            </article>
            <article class="card">
              <p class="muted">Бюджет</p>
              <p class="metric" id="orders-budget">0,00 UZT</p>
              <p class="muted">Израсходовано с начала кампаний.</p>
            </article>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>Мои кампании</h3>
              <div class="panel__actions filter-group" data-filter-group="orders">
                <button class="btn btn--chip is-active" data-order-filter="all">Все</button>
                <button class="btn btn--chip" data-order-filter="active">Активные</button>
                <button class="btn btn--chip" data-order-filter="completed">Завершённые</button>
                <button class="btn btn--chip" data-order-filter="draft">Черновики</button>
              </div>
            </div>
            <ul class="list" id="orders-list"></ul>
            <p class="muted" id="orders-empty">Заказов пока нет.</p>
          </div>
        </section>

        <section class="view" id="view-payments" data-view="payments" hidden>
          <header class="section-header">
            <div>
              <h2>Пополнения</h2>
              <p class="muted">Пополняйте баланс и отслеживайте статусы платежей.</p>
            </div>
            <div class="section-actions">
              <button class="btn btn--ghost" id="payments-refresh">Обновить</button>
              <button class="btn btn--primary" id="payments-open">Пополнить баланс</button>
            </div>
          </header>

          <div class="grid grid--cards payments-highlight">
            <article class="card">
              <h3>Текущий баланс</h3>
              <p class="metric" id="payments-balance">0,00 UZT</p>
              <p class="muted">Средства доступны для списания и заказов.</p>
            </article>
            <article class="card">
              <h3>Последнее пополнение</h3>
              <p class="metric" id="payments-last">—</p>
              <p class="muted">Сумма и дата последнего успешного платежа.</p>
            </article>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>История пополнений</h3>
            </div>
            <ul class="list" id="payments-list"></ul>
            <p class="muted" id="payments-empty">Платежей пока не было.</p>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>Доступные способы</h3>
            </div>
            <div class="payment-methods" id="payment-methods">
              <button class="payment-methods__item" data-payment-method="card">
                <span class="payment-methods__title">Банковская карта</span>
                <span class="payment-methods__meta">Моментальное зачисление</span>
              </button>
              <button class="payment-methods__item" data-payment-method="crypto">
                <span class="payment-methods__title">USDT / криптовалюта</span>
                <span class="payment-methods__meta">Конвертация по биржевому курсу</span>
              </button>
              <button class="payment-methods__item" data-payment-method="manual">
                <span class="payment-methods__title">Ручное пополнение</span>
                <span class="payment-methods__meta">Заявка обрабатывается менеджером</span>
              </button>
            </div>
          </div>
        </section>

        <section class="view" id="view-profile" data-view="profile" hidden>
          <header class="section-header">
            <div>
              <h2>Профиль</h2>
              <p class="muted">Обновляйте персональные данные и делитесь реферальной ссылкой.</p>
            </div>
            <div class="section-actions">
              <button class="btn btn--ghost" id="profile-refresh">Обновить</button>
              <button class="btn btn--danger" id="profile-delete">Удалить аккаунт</button>
            </div>
          </header>

          <div class="grid grid--two profile-grid">
            <article class="card profile-summary" id="profile-summary">
              <div class="profile-summary__avatar" aria-hidden="true">УБ</div>
              <div class="profile-summary__content">
                <h3 id="profile-summary-name">Пользователь</h3>
                <p class="muted">Аккаунт Telegram WebApp</p>
                <dl class="description profile-summary__stats">
                  <div>
                    <dt>Баланс</dt>
                    <dd id="profile-summary-balance">0,00 UZT</dd>
                  </div>
                  <div>
                    <dt>Заработано</dt>
                    <dd id="profile-summary-earned">0,00 UZT</dd>
                  </div>
                  <div>
                    <dt>Язык</dt>
                    <dd id="profile-summary-language">ru</dd>
                  </div>
                </dl>
              </div>
              <div class="profile-summary__ref">
                <p class="muted">Реферальная ссылка</p>
                <code class="profile-summary__ref-link" id="profile-referral-link">https://t.me/uzinex_boost_bot</code>
                <button class="btn btn--ghost btn--small" id="profile-copy-ref">Скопировать</button>
              </div>
            </article>

            <article class="card">
              <h3>Настройки профиля</h3>
              <form class="form" id="profile-form">
                <div class="form__field">
                  <label for="profile-username">Имя пользователя</label>
                  <input id="profile-username" name="username" type="text" placeholder="@username" />
                </div>
                <div class="form__field">
                  <label for="profile-language">Язык интерфейса</label>
                  <select id="profile-language" name="language">
                    <option value="ru">Русский</option>
                    <option value="uz">O'zbekcha</option>
                    <option value="en">English</option>
                  </select>
                </div>
                <button class="btn btn--primary" type="submit" id="profile-submit">Сохранить изменения</button>
              </form>
            </article>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>Рефералы</h3>
            </div>
            <ul class="list list--compact" id="referrals-list"></ul>
            <p class="muted" id="referrals-empty">Пока нет приглашённых пользователей.</p>
          </div>
        </section>
      </main>
    </div>

    <div class="toast-container" aria-live="polite" aria-atomic="true"></div>

    <template id="task-item-template">
      <li class="list__item">
        <div>
          <p class="list__title"></p>
          <p class="list__meta"></p>
        </div>
        <button class="btn btn--small">Выполнить</button>
      </li>
    </template>

    <template id="order-item-template">
      <li class="list__item">
        <div>
          <p class="list__title"></p>
          <p class="list__meta"></p>
        </div>
        <div class="list__actions">
          <button class="btn btn--ghost btn--small" data-action="open-order">Открыть</button>
        </div>
      </li>
    </template>

    <template id="payment-item-template">
      <li class="list__item">
        <div>
          <p class="list__title"></p>
          <p class="list__meta"></p>
        </div>
        <div class="list__actions">
          <button class="btn btn--ghost btn--small" data-action="open-payment">Подробнее</button>
        </div>
      </li>
    </template>

    <template id="history-item-template">
      <div class="timeline__item">
        <span class="timeline__time"></span>
        <div class="timeline__content">
          <p class="timeline__title"></p>
          <p class="timeline__meta"></p>
        </div>
      </div>
    </template>

    <template id="referral-item-template">
      <li class="list__item list__item--neutral">
        <div>
          <p class="list__title"></p>
          <p class="list__meta"></p>
        </div>
      </li>
    </template>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
