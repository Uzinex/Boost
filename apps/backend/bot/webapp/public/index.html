<!DOCTYPE html>
<html lang="ru" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <title>Uzinex Boost WebApp</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles/main.css" />
    <script id="boost-config" type="application/json">
      {
        "apiBaseUrl": "/api/v1",
        "botToken": ""
      }
    </script>
  </head>
  <body>
    <div class="app-shell">
      <header class="app-header">
        <div>
          <h1 class="app-title">Uzinex Boost</h1>
          <p class="app-subtitle">Telegram WebApp · заработок и продвижение</p>
        </div>
        <div class="user-chip" id="user-chip">
          <span class="user-chip__name" id="chip-name">—</span>
          <span class="user-chip__balance" id="chip-balance">0 UZT</span>
        </div>
      </header>

      <nav class="app-nav" aria-label="Основная навигация">
        <button class="nav-btn is-active" data-view="dashboard">Главная</button>
        <button class="nav-btn" data-view="tasks">Задания</button>
        <button class="nav-btn" data-view="orders">Заказы</button>
        <button class="nav-btn" data-view="payments">Пополнения</button>
        <button class="nav-btn" data-view="profile">Профиль</button>
      </nav>

      <main class="app-main">
        <section class="view" id="view-dashboard" data-view="dashboard">
          <div class="grid grid--cards" id="dashboard-cards">
            <article class="card">
              <h2>Баланс</h2>
              <p class="metric" id="metric-balance">—</p>
              <p class="muted">Актуальный баланс в UZT</p>
            </article>
            <article class="card">
              <h2>Заработано</h2>
              <p class="metric" id="metric-earned">—</p>
              <p class="muted">Всего начислено за задания</p>
            </article>
            <article class="card">
              <h2>Заказы</h2>
              <p class="metric" id="metric-orders">—</p>
              <p class="muted">Активные и завершённые кампании</p>
            </article>
            <article class="card">
              <h2>Рефералы</h2>
              <p class="metric" id="metric-referrals">—</p>
              <p class="muted">Приглашённые пользователи</p>
            </article>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>Актуальные задания</h3>
              <button class="btn btn--ghost" id="refresh-dashboard-tasks">Обновить</button>
            </div>
            <ul class="list" id="dashboard-tasks"></ul>
            <p class="muted" id="dashboard-tasks-empty">Пока нет активных заданий.</p>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>История операций</h3>
              <div class="panel__actions">
                <button class="btn btn--ghost" id="refresh-dashboard-history">Обновить</button>
                <button class="btn btn--ghost" id="open-payments-view" data-view="payments">Все операции</button>
              </div>
            </div>
            <div class="timeline" id="dashboard-history"></div>
            <p class="muted" id="dashboard-history-empty">Операций ещё не было.</p>
          </div>
        </section>

        <section class="view" id="view-tasks" data-view="tasks" hidden>
          <header class="section-header">
            <div>
              <h2>Задания</h2>
              <p class="muted">
                Выполняйте задания и получайте вознаграждение. После выполнения задача автоматически
                проверяется и начисляет UZT.
              </p>
            </div>
            <div class="section-actions">
              <button class="btn" id="refresh-tasks">Обновить список</button>
              <button class="btn btn--ghost" id="refresh-task-history">История</button>
            </div>
          </header>

          <div class="panel">
            <h3>Доступные задания</h3>
            <ul class="list" id="tasks-list"></ul>
            <p class="muted" id="tasks-empty">Нет доступных заданий. Проверьте позже.</p>
          </div>

          <div class="panel">
            <h3>Выполнено недавно</h3>
            <ul class="list list--compact" id="tasks-history"></ul>
            <p class="muted" id="tasks-history-empty">Вы ещё не выполняли задания.</p>
          </div>
        </section>

        <section class="view" id="view-orders" data-view="orders" hidden>
          <header class="section-header">
            <div>
              <h2>Заказы</h2>
              <p class="muted">
                Создавайте кампании на продвижение каналов и групп. Стоимость списывается автоматически с баланса.
              </p>
            </div>
            <div class="section-actions">
              <button class="btn" id="refresh-orders">Обновить список</button>
            </div>
          </header>

          <div class="panel">
            <h3>Новый заказ</h3>
            <form class="form" id="order-form">
              <div class="form__row">
                <label class="form__field">
                  <span>Тип заказа</span>
                  <select name="order_type" required>
                    <option value="channel">Канал</option>
                    <option value="group">Группа</option>
                  </select>
                </label>
                <label class="form__field">
                  <span>Количество</span>
                  <input name="quantity" type="number" min="10" max="10000" step="10" required />
                </label>
              </div>
              <label class="form__field">
                <span>Ссылка на канал/группу</span>
                <input name="target_url" type="url" placeholder="https://t.me/uzinex" required />
              </label>
              <p class="muted">
                Стоимость рассчитывается автоматически: 0.6 UZT за подписчика канала, 0.4 UZT за участника группы.
              </p>
              <button type="submit" class="btn btn--primary">Создать заказ</button>
            </form>
          </div>

          <div class="panel">
            <h3>Мои заказы</h3>
            <div class="table" role="table">
              <div class="table__head" role="row">
                <span role="columnheader">ID</span>
                <span role="columnheader">Тип</span>
                <span role="columnheader">Цель</span>
                <span role="columnheader">Статус</span>
                <span role="columnheader">Прогресс</span>
                <span role="columnheader">Стоимость</span>
                <span role="columnheader">Действия</span>
              </div>
              <div class="table__body" id="orders-table"></div>
            </div>
            <p class="muted" id="orders-empty">У вас пока нет заказов.</p>
          </div>
        </section>

        <section class="view" id="view-payments" data-view="payments" hidden>
          <header class="section-header">
            <div>
              <h2>Пополнения и операции</h2>
              <p class="muted">Создавайте заявки на пополнение и отслеживайте статусы платежей.</p>
            </div>
            <div class="section-actions">
              <button class="btn" id="refresh-payments">Обновить</button>
            </div>
          </header>

          <div class="panel">
            <h3>Ручная заявка на пополнение</h3>
            <form class="form" id="manual-payment-form">
              <div class="form__row">
                <label class="form__field">
                  <span>Сумма, UZT</span>
                  <input name="amount" type="number" min="100" step="10" required />
                </label>
                <label class="form__field">
                  <span>Ссылка на чек</span>
                  <input name="check_photo_url" type="text" placeholder="File ID или URL" required />
                </label>
              </div>
              <p class="muted">После создания заявки ожидайте подтверждения администратором.</p>
              <button type="submit" class="btn btn--primary">Отправить заявку</button>
            </form>
          </div>

          <div class="panel">
            <h3>История операций</h3>
            <div class="table" role="table">
              <div class="table__head" role="row">
                <span role="columnheader">Дата</span>
                <span role="columnheader">Тип</span>
                <span role="columnheader">Сумма</span>
                <span role="columnheader">Статус</span>
                <span role="columnheader">Комментарий</span>
              </div>
              <div class="table__body" id="payments-table"></div>
            </div>
            <p class="muted" id="payments-empty">Операций пока нет.</p>
          </div>
        </section>

        <section class="view" id="view-profile" data-view="profile" hidden>
          <header class="section-header">
            <div>
              <h2>Профиль</h2>
              <p class="muted">Обновляйте персональные данные, синхронизируйте баланс и управляйте аккаунтом.</p>
            </div>
            <div class="section-actions">
              <button class="btn btn--ghost" id="sync-balance">Синхронизировать баланс</button>
            </div>
          </header>

          <div class="grid grid--two">
            <div class="panel">
              <h3>Данные аккаунта</h3>
              <dl class="description" id="profile-summary"></dl>
            </div>
            <div class="panel">
              <h3>Изменить профиль</h3>
              <form class="form" id="profile-form">
                <label class="form__field">
                  <span>Username</span>
                  <input name="username" type="text" placeholder="username" />
                </label>
                <label class="form__field">
                  <span>Язык интерфейса</span>
                  <select name="language">
                    <option value="ru">Русский</option>
                    <option value="en">English</option>
                    <option value="uz">O'zbekcha</option>
                  </select>
                </label>
                <button type="submit" class="btn btn--primary">Сохранить</button>
              </form>
            </div>
          </div>

          <div class="panel">
            <div class="panel__header">
              <h3>Реферальная программа</h3>
              <button class="btn btn--ghost" id="refresh-referrals">Обновить</button>
            </div>
            <ul class="list" id="referrals-list"></ul>
            <p class="muted" id="referrals-empty">Рефералов пока нет.</p>
          </div>

          <div class="panel panel--danger">
            <div class="panel__header">
              <h3>Опасная зона</h3>
              <p class="muted">Удаление аккаунта необратимо и приведёт к потере данных.</p>
            </div>
            <button class="btn btn--danger" id="delete-account">Удалить аккаунт</button>
          </div>
        </section>
      </main>
    </div>

    <div class="toast-container" aria-live="polite" aria-atomic="true"></div>

    <template id="task-item-template">
      <li class="list__item">
        <div>
          <p class="list__title"></p>
          <p class="list__meta"></p>
        </div>
        <button class="btn btn--small">Выполнить</button>
      </li>
    </template>

    <template id="history-item-template">
      <div class="timeline__item">
        <span class="timeline__time"></span>
        <div class="timeline__content">
          <p class="timeline__title"></p>
          <p class="timeline__meta"></p>
        </div>
      </div>
    </template>

    <template id="referral-item-template">
      <li class="list__item list__item--neutral">
        <div>
          <p class="list__title"></p>
          <p class="list__meta"></p>
        </div>
      </li>
    </template>

    <script type="module" src="./scripts/main.js"></script>
  </body>
</html>
